function tagsActionHandler(){document.location.href.indexOf("tags")<0||($(".tag-add").on("click",function(){tagAdd()}),$(".btn-tags-checkbox").on("click",function(){tagsCheckboxHandler()}),$(".tag-action div").on("click",function(){var a=$(this).closest(".tags-list").attr("id").split("-")[1];switch($(this).attr("class")){case"tag-edit":tagEdit(a);break;case"tag-delete":tagsDelete(a)}}),tagsTableSortable())}function tagsTableSortable(){var a=[];$(".table-tags-body").sortable({appendTo:"parent",handle:".fa-bars",start:function(t,e){$(this).children().each(function(){$(this).hasClass("ui-sortable-placeholder")||a.push($(this).attr("id").split("-")[2])})},update:function(t,e){var s=[],o=[];$(this).children().each(function(){$(this).hasClass("ui-sortable-placeholder")||s.push($(this).attr("id").split("-")[1])}),$.each(s,function(t,e){o.push({id:[e],position:a[t]})}),o=JSON.stringify(o),$.post("/admin/tags/ajax",{action:"update-position",json:o},function(a){"ok"==a?$.toast({text:"Change saved!",icon:"success"}):$.toast({text:"An error has occurred!",icon:"error"})})}}).disableSelection()}function tagsCheckboxHandler(){var a=$("#list-tags-form").serialize();a.indexOf("select-action=delete")+1&&(a+="&action=delete"),a.indexOf("id")+1?bootbox.dialog({message:"Perform selected action?",buttons:{success:{label:"Yes",className:"btn-success",callback:function(){$.post("/admin/tags/ajax",a,function(a){"ok"==a?$.toast({text:"Changes saved!",icon:"success"}):$.toast({text:"An error has occurred!",icon:"error"}),updateOuter()})}},danger:{label:"No",className:"btn-danger",callback:function(){}}}}):bootbox.alert("You have not chosen anything!")}function tagAdd(){$.post("/admin/tags/ajax",{action:"get-form-add"},function(a){bootbox.dialog({title:"Add new tag",message:a,className:"big-modal",buttons:{success:{label:"Save",className:"btn-success",callback:function(){return $("#tag-form-add").submit(),!1}},danger:{label:"Cancel",className:"btn-danger",callback:function(){}}}}),$("#tag-form-add").bootstrapValidator({excluded:[":disabled"],fields:{name:{validators:{notEmpty:{message:"Cannot be empty."},stringLength:{max:255,message:"255 characters maximum"},remote:{message:"A tag with the same name already exists.",data:{action:"check-free-name"},url:"/admin/tags/ajax",type:"POST",delay:0}}}}}).on("success.form.bv",function(a){a.preventDefault?a.preventDefault():a.returnValue=!1;var t=$.param({action:"add"});$.post("/admin/tags/ajax",$(a.target).serialize()+"&"+t,function(a){"ok"==a?(bootbox.hideAll(),$.toast({text:"Tag added!",icon:"success"})):$.toast({text:"An error has occurred!",icon:"error"}),updateOuter()})})})}function tagEdit(a){$.post("/admin/tags/ajax",{action:"get-form-edit",id:a},function(t){bootbox.dialog({title:"Tag editing",message:t,className:"big-modal",buttons:{success:{label:"Save",className:"btn-success",callback:function(){return $("#tag-form-edit").submit(),!1}},danger:{label:"Cancel",className:"btn-danger",callback:function(){}}}}),$("#tag-form-edit").bootstrapValidator({excluded:[":disabled"],fields:{name:{validators:{notEmpty:{message:"Cannot be empty."},stringLength:{max:255,message:"255 characters maximum"},remote:{message:"A tag with the same name already exists.",data:{action:"check-free-name",id:a},url:"/admin/tags/ajax",type:"POST",delay:0}}}}}).on("success.form.bv",function(t){t.preventDefault?t.preventDefault():t.returnValue=!1;var e=$.param({action:"update",id:[a]});$.post("/admin/tags/ajax",$(t.target).serialize()+"&"+e,function(a){"ok"==a?(bootbox.hideAll(),$.toast({text:"Changes saved!",icon:"success"})):$.toast({text:"An error has occurred!",icon:"error"}),updateOuter()})})})}function tagsDelete(a){bootbox.dialog({message:"Delete selected tags?",buttons:{success:{label:"Yes",className:"btn-success",callback:function(){$.post("/admin/tags/ajax",{action:"delete","id[]":a},function(a){"ok"==a?$.toast({text:"Tag removed!",icon:"success"}):$.toast({text:"An error has occurred!",icon:"error"}),updateOuter()})}},danger:{label:"No",className:"btn-danger",callback:function(){}}}})}