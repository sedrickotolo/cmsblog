function contentActionHandler(){document.location.href.indexOf("content")<0||($(".category-list").ntm(),$(".content-add").on("click",function(){contentAdd()}),$(".btn-content-checkbox").on("click",function(){contentCheckboxHandler()}),$(".content-action div").on("click",function(){var e=$(this).closest(".content-list").attr("id").split("-")[1];$(this).closest(".content-list").data("type");switch($(this).attr("class")){case"content-edit":contentEdit(e);break;case"content-update-status-on":contentUpdateStatus(e,0);break;case"content-update-status-off":contentUpdateStatus(e,1);break;case"content-delete":contentDelete(e)}}),contentTableSortable())}function contentTableSortable(){var e=[];$(".table-content-body").sortable({appendTo:"parent",handle:".fa-bars",start:function(t,a){$(this).children().each(function(){$(this).hasClass("ui-sortable-placeholder")||e.push($(this).attr("id").split("-")[2])})},update:function(t,a){var n=[],o=[];$(this).children().each(function(){$(this).hasClass("ui-sortable-placeholder")||n.push($(this).attr("id").split("-")[1])}),$.each(n,function(t,a){o.push({id:[a],position:e[t]})}),o=JSON.stringify(o),$.post("/admin/content/ajax",{action:"update-position",json:o},function(e){"ok"==e?$.toast({text:"Change saved!",icon:"success"}):$.toast({text:"An error has occurred!",icon:"error"})})}}).disableSelection()}function contentCheckboxHandler(){var e=$("#list-content-form").serialize();e.indexOf("select-action=enable")+1?e+="&action=update&status=1":e.indexOf("select-action=disable")+1?e+="&action=update&status=0":e.indexOf("select-action=delete")+1&&(e+="&action=delete"),e.indexOf("id")+1?bootbox.dialog({message:"Perform selected action?",buttons:{success:{label:"Yes",className:"btn-success",callback:function(){$.post("/admin/content/ajax",e,function(e){"ok"==e?$.toast({text:"Changes saved!",icon:"success"}):$.toast({text:"An error has occurred!",icon:"error"}),updateOuter()})}},danger:{label:"No",className:"btn-danger",callback:function(){}}}}):bootbox.alert("You have not chosen anything!")}function contentElementsSerialize(){var e={previews:$('input:radio[name="preview-element"]:checked').val(),elements:[],property:{}};return $(".element-item").each(function(){e.elements.push($(this).data("element"))}),$(".element-property-item").each(function(){e.property[$(this).attr("id")]=$(this).is(":checked")?1:0}),JSON.stringify(e)}function contentAdd(){$.post("/admin/content/ajax",{action:"get-form-add"},function(e){bootbox.dialog({title:"Adding a new entry",message:e,className:"big-modal",buttons:{success:{label:"Save",className:"btn-success",callback:function(){return $("#content-form-add").submit(),!1}},danger:{label:"Cancel",className:"btn-danger",callback:function(){}}}}).on("hidden.bs.modal",function(){$(document).off("click",".slider-image-replace"),$(document).off("click",".slider-image-delete"),$(document).off("click",".video-delete"),$(document).off("click",".image-delete")}),editorInit(),formBuilder(),videoHandler(),imagesHandler(),imagesSliderHandler(),$(".date-time-picker").datetimepicker({format:"YYYY-MM-DD HH:mm:ss",locale:"en"}),$(".selectpicker").selectpicker({container:".big-modal",iconBase:"fa",tickIcon:"fa-check-square-o"}),$(".translit-in").on("input",function(){$(this).liTranslit({elAlias:$(".translit-out")})}),$(".input-in").change(function(){$(".input-out").val($(this).val())}),$(".check-box-picker").checkboxpicker(),$(".elements-list").sortable(),$(".token-field").tokenfield(),$("#content-form-add").bootstrapValidator({excluded:[":disabled"],fields:{url:{validators:{notEmpty:{message:"Cannot be empty."},remote:{message:"This URL is already in use.",data:{action:"check-free-url"},url:"/admin/content/ajax",type:"POST",delay:0}}},title:{validators:{notEmpty:{message:"Cannot be empty."},stringLength:{max:255,message:"255 characters maximum"}}},header:{validators:{notEmpty:{message:"Cannot be empty."},stringLength:{max:255,message:"255 characters maximum"}}},shortentry:{validators:{notEmpty:{message:"Cannot be empty."}}},fullentry:{validators:{notEmpty:{message:"Cannot be empty."}}},description:{validators:{stringLength:{max:160,message:"255 characters maximum"}}}}}).on("success.form.bv",function(e){e.preventDefault?e.preventDefault():e.returnValue=!1;var t=$.param({elements:contentElementsSerialize(),slider:imagesSliderSerialize(),images:imagesSerialize(),video:videoSerialize(),form:formBuilderSerialize(),action:"add"});$.post("/admin/content/ajax",$(e.target).serialize()+"&"+t,function(e){"ok"==e?(bootbox.hideAll(),$.toast({text:"Record added!",icon:"success"})):$.toast({text:"An error has occurred!",icon:"error"}),updateOuter()})})})}function contentEdit(e){$.post("/admin/content/ajax",{action:"get-form-edit",id:e},function(t){bootbox.dialog({title:"Edit record",message:t,className:"big-modal",buttons:{success:{label:"Save",className:"btn-success",callback:function(){return $("#content-form-edit").submit(),!1}},danger:{label:"Cancel",className:"btn-danger",callback:function(){}}}}).on("hidden.bs.modal",function(){$(document).off("click",".slider-image-replace"),$(document).off("click",".slider-image-delete"),$(document).off("click",".video-delete"),$(document).off("click",".image-delete")}),editorInit(),formBuilder(),videoHandler(),imagesHandler(),imagesSliderHandler(),$(".date-time-picker").datetimepicker({format:"YYYY-MM-DD HH:mm:ss",locale:"en"}),$(".selectpicker").selectpicker({container:".big-modal",iconBase:"fa",tickIcon:"fa-check-square-o"}),$(".translit-in").on("input",function(){$(this).liTranslit({elAlias:$(".translit-out")})}),$(".input-in").change(function(){$(".input-out").val($(this).val())}),$(".check-box-picker").checkboxpicker(),$(".elements-list").sortable(),$(".token-field").tokenfield(),$("#content-form-edit").bootstrapValidator({excluded:[":disabled"],fields:{url:{validators:{notEmpty:{message:"Cannot be empty."},remote:{message:"This URL is already in use.",data:{action:"check-free-url",id:e},url:"/admin/content/ajax",type:"POST",delay:0}}},title:{validators:{notEmpty:{message:"Cannot be empty."},stringLength:{max:255,message:"255 characters maximum"}}},header:{validators:{notEmpty:{message:"Cannot be empty."},stringLength:{max:255,message:"255 characters maximum"}}},shortentry:{validators:{notEmpty:{message:"Cannot be empty."}}},fullentry:{validators:{notEmpty:{message:"Cannot be empty."}}},description:{validators:{stringLength:{max:160,message:"255 characters maximum"}}}}}).on("success.form.bv",function(t){t.preventDefault?t.preventDefault():t.returnValue=!1;var a=$.param({elements:contentElementsSerialize(),slider:imagesSliderSerialize(),images:imagesSerialize(),video:videoSerialize(),form:formBuilderSerialize(),action:"update",id:[e]});$.post("/admin/content/ajax",$(t.target).serialize()+"&"+a,function(e){"ok"==e?(bootbox.hideAll(),$.toast({text:"Changes saved!",icon:"success"})):$.toast({text:"An error has occurred!",icon:"error"}),updateOuter()})})})}function contentUpdateStatus(e,t){var a="";a=1==t?"Post to website?":"Hide from site?",bootbox.dialog({message:a,buttons:{success:{label:"Yes",className:"btn-success",callback:function(){$.post("/admin/content/ajax",{action:"update",status:t,"id[]":e},function(e){"ok"==e?$.toast({text:"Changes saved!",icon:"success"}):$.toast({text:"An error has occurred!",icon:"error"}),updateOuter()})}},danger:{label:"No",className:"btn-danger",callback:function(){}}}})}function contentDelete(e){bootbox.dialog({message:"Delete this entry?",buttons:{success:{label:"Yes",className:"btn-success",callback:function(){$.post("/admin/content/ajax",{action:"delete","id[]":e},function(e){"ok"==e?$.toast({text:"Record deleted!",icon:"success"}):$.toast({text:"An error has occurred!",icon:"error"}),updateOuter()})}},danger:{label:"No",className:"btn-danger",callback:function(){}}}})}